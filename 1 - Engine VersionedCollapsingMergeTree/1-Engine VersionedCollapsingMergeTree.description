1. Engine VersionedCollapsingMergeTree  

На основе анализа данных, добавляемых в таблицу tbl1, становится очевидно, что есть необходимость в изменении существующих данных. 

Движок VersionedCollapsingMergeTree позволяет удалить строки через алгоритм сворачивания, причем порядок вставки строк никак не влияет корректную работу данного движка в отличие от похожего CollapsingMergeTree, который требует строгой последовательности вставки данных.