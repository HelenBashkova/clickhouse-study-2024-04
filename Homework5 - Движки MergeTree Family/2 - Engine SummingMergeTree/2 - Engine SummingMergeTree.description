Engine SummingMergeTree обеспечивает хранение только сумм значений из столбцов с цифровым типом данных. 
В конкретном случае – это суммы по столбцу val, с группировкой по столбцу key.